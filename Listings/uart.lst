C51 COMPILER V9.60.7.0   UART                                                              05/05/2023 16:30:07 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\Objects\uart.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE Public\uart.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Public;.\Tool) DEBUG OBJ
                    -ECTEXTEND PRINT(.\Listings\uart.lst) TABS(2) OBJECT(.\Objects\uart.obj)

line level    source

   1          #include "uart.h"
   2          #include "public.h"
   3          
   4          /*******************************************************************************
   5          * 函 数 名         : Uart_init
   6          * 函数功能           : 串口初始化函数
   7          * 输    入         : baud：波特率
   8          * 输    出         : 无
   9          * 说    名         : 无
  10          *******************************************************************************/
  11          void Uart_init(uchar baud)
  12          {
  13   1        TMOD|=0X20; //设置计数器工作方式2
  14   1        SCON=0X50;  //设置为工作方式1
  15   1        PCON=0X80;  //波特率加倍
  16   1        TH1=baud; //计数器初始值设置
  17   1        TL1=baud;
  18   1        ES=1;   //打开接收中断
  19   1        EA=1;   //打开总中断
  20   1        TR1=1;    //打开计数器    
  21   1      }
  22          
  23          /*******************************************************************************
  24          * 函 数 名         : Send_Uart
  25          * 函数功能           : 串口发送一个字节数据
  26          * 输    入         : value：数据
  27          * 输    出         : 无
  28          * 说    名         : 无
  29          *******************************************************************************/
  30          void Send_uart(uchar value)
  31          {
  32   1            ES=0;         
  33   1            TI=0;         
  34   1            SBUF=value;     
  35   1            while(TI==0);    
  36   1            TI=0;         
  37   1            ES=1;        
  38   1      }
  39          
  40          /*******************************************************************************
  41          * 函 数 名         : Send_str
  42          * 函数功能           : 串口发送字符串
  43          * 输    入         : *pur：指针型数据，指向待发数据的首地址
  44          * 输    出         : 无
  45          * 说    名         : 无
  46          *******************************************************************************/
  47          void Send_str(uchar *puf)             
  48          {
  49   1      
  50   1            while(*puf!='\0')   
  51   1            {
  52   2                 Send_uart(*puf);
  53   2                 Delay_us(5);       //public库中的延时函数
  54   2                 puf++;      
C51 COMPILER V9.60.7.0   UART                                                              05/05/2023 16:30:07 PAGE 2   

  55   2            }
  56   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     74    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
