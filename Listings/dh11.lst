C51 COMPILER V9.60.7.0   DH11                                                              05/05/2023 16:30:08 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE DH11
OBJECT MODULE PLACED IN .\Objects\dh11.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE Tool\dh11.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Public;.\Tool) DEBUG OBJEC
                    -TEXTEND PRINT(.\Listings\dh11.lst) TABS(2) OBJECT(.\Objects\dh11.obj)

line level    source

   1          #include "dh11.h"
   2          uchar wen_dat[16];    //用于显示温湿度的接收数据数组
   3          /****************************************************************************
   4          *函数名：DHT11_rec_byte
   5          *输  入：无
   6          *输  出：无
   7          *功  能：DH11初始化
   8          ****************************************************************************/
   9          void DHT11_start()
  10          {
  11   1         Data=1;
  12   1         Delay_us(2);
  13   1         Data=0;
  14   1         Delay_ms(20);   //延时18ms以上
  15   1         Data=1;
  16   1         Delay_us(30);
  17   1      }
  18          
  19          /****************************************************************************
  20          *函数名：DHT11_rec_byte
  21          *输  入：无
  22          *输  出：dat:一个字节的数据
  23          *功  能：接收一个字节
  24          ****************************************************************************/
  25          uchar DHT11_rec_byte()      
  26          {
  27   1         uchar i,dat=0;
  28   1         for(i=0;i<8;i++)    //从高到低依次接收8位数据
  29   1         {          
  30   2            while(!Data);   //等待50us低电平过去
  31   2            Delay_us(8);     //延时60us，如果还为高则数据为1，否则为0 
  32   2            dat<<=1;           //移位使正确接收8位数据，数据为0时直接移位
  33   2            if(Data==1)    //数据为1时，使dat加1来接收数据1
  34   2               dat+=1;
  35   2            while(Data);  //等待数据线拉低    
  36   2          }  
  37   1          return dat;
  38   1      }
  39          
  40          /****************************************************************************
  41          *函数名：DHT11_receive
  42          *输  入：无
  43          *输  出：无
  44          *功  能：接收40位的数据
  45          ****************************************************************************/
  46          void DHT11_receive()      
  47          {
  48   1        uchar R_H,R_L,T_H,T_L,RH,RL,TH,TL,revise; 
  49   1        DHT11_start();
  50   1        if(Data==0)
  51   1        {
  52   2          while(Data==0);   //等待拉高     
  53   2          Delay_us(40);  //拉高后延时80us
  54   2          R_H=DHT11_rec_byte();    //接收湿度高八位  
C51 COMPILER V9.60.7.0   DH11                                                              05/05/2023 16:30:08 PAGE 2   

  55   2          R_L=DHT11_rec_byte();    //接收湿度低八位  
  56   2          T_H=DHT11_rec_byte();    //接收温度高八位  
  57   2          T_L=DHT11_rec_byte();    //接收温度低八位
  58   2          revise=DHT11_rec_byte(); //接收校正位
  59   2      
  60   2          Delay_us(25);    //结束
  61   2      
  62   2          if((R_H+R_L+T_H+T_L)==revise)      //校正
  63   2          {
  64   3            RH=R_H;
  65   3            RL=R_L;
  66   3            TH=T_H;
  67   3            TL=T_L;
  68   3          } 
  69   2              /*数据处理，方便显示*/
  70   2              wen_dat[0]='S';
  71   2              wen_dat[1]='h';
  72   2              wen_dat[2]='i';
  73   2              wen_dat[3]=':';
  74   2              wen_dat[4]='0'+(RH/10);
  75   2              wen_dat[5]='0'+(RH%10);
  76   2              wen_dat[6]='R';
  77   2              wen_dat[7]='H';
  78   2              wen_dat[8]=' ';
  79   2              wen_dat[9]='T';
  80   2              wen_dat[10]='e';
  81   2              wen_dat[11]='m';
  82   2              wen_dat[12]=':';
  83   2              wen_dat[13]='0'+(TH/10);
  84   2              wen_dat[14]='0'+(TH%10);
  85   2              wen_dat[15]='C';
  86   2      
  87   2        }
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    234    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     16      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
